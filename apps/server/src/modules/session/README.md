# Session Module (P0-04)

## Назначение

- Подтверждает старт сессии обоими участниками.
- Переводит сессию в состояние `WAITING_FOR_START` или `ACTIVE`.
- Уведомляет участников событием `session_started`.
- После старта отправляет первый шаг диалога событием `session_step`.
- Обрабатывает ответы на шаг через `POST /session/step/answer` и рассылает следующий шаг.
- Завершает сессию через `POST /session/end` или при терминальном шаге.
- Отправляет `session_ended` и очищает состояние участников.
- При восстановлении активной сессии возвращает текущий шаг через `POST /session/resume`.
- Если сессия в состоянии `PARTNER_FOUND` или `WAITING_FOR_START`, возвращает
  соответствующий статус для восстановления экрана мэтча.
- Если пользователь находится в очереди (`WAITING_FOR_PARTNER`), `POST /session/resume`
  возвращает статус `QUEUED`, чтобы восстановить экран поиска.

## Контракты

- `POST /session/start`
- `POST /session/resume`
- `POST /session/step/answer`
- `POST /session/end`
- WS событие: `session_started`
- WS событие: `session_step`
- WS событие: `session_ended`

## Обоснование

Ручной handshake снижает количество AFK стартов и синхронизирует начало диалога
для обоих участников. Первый шаг приходит отдельным событием и не требует логики
на клиенте.
